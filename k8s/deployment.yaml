apiVersion: apps/v1
kind: Deployment
metadata: { name: fsu-api, namespace: factsynth }
spec:
  replicas: 2
  selector: { matchLabels: { app: fsu-api } }
  template:
    metadata: { labels: { app: fsu-api } }
    spec:
      containers:
      - name: api
        image: ghcr.io/OWNER/factsynth-ultimate:latest
        ports: [{ containerPort: 8000, name: http }]
        env:
          - name: API_KEY
            valueFrom: { secretKeyRef: { name: fsu-secret, key: api_key } }
        readinessProbe: { httpGet: { path: /v1/healthz, port: http }, initialDelaySeconds: 5, periodSeconds: 10 }
        livenessProbe:  { httpGet: { path: /v1/healthz, port: http }, initialDelaySeconds: 10, periodSeconds: 20 }
        resources:
          requests: { cpu: "100m", memory: "256Mi" }
          limits:   { cpu: "500m", memory: "512Mi" }
