name: CodeQL
on:
  push: { branches: [ main ] }
  pull_request: { branches: [ main ] }
  schedule: [ { cron: '19 3 * * 5' } ]
permissions:
  contents: read
  security-events: write
concurrency: { group: codeql-${{ github.ref }}, cancel-in-progress: true }
jobs:
  analyze:
    runs-on: ubuntu-latest
    timeout-minutes: 60
    strategy:
      fail-fast: false
      matrix:
        language: [ javascript, python ]
    steps:
      - uses: actions/checkout@ff7abcd0c3c05ccf6adc123a8cd1fd4fb30fb493 # actions/checkout
      - uses: actions/setup-node@cd2651c46231bc0d6f48d6b34433b845331235fe # actions/setup-node
        with: { node-version: '20', cache: 'npm' }
      - run: npm ci
      - uses: actions/setup-python@e797f83bcb11b83ae66e0230d6156d7c80228e7c # actions/setup-python
        with: { python-version: '3.11', cache: 'pip' }
      - run: pip install -e .[dev]
      - uses: github/codeql-action/init@aa90e97ad2ed17cde6a43e89f70138299e64f837 # github/codeql-action/init
        with: { languages: ${{ matrix.language }} }
      - uses: github/codeql-action/analyze@aa90e97ad2ed17cde6a43e89f70138299e64f837 # github/codeql-action/analyze
